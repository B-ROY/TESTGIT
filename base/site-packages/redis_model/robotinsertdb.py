#encoding=utf-8

import os
import MySQLdb
import random
config = {
  'user': 'root',
  'password': '123456',
  'host': '127.0.0.1',
  'database': 'livevideo_platform',
  'raise_on_warnings': True,
}

"""
这个是自动将机器人加入到用户表中
"""

cnx = MySQLdb.connect("10.66.109.98","root","2RKE#zyeq1","livevideo_platform" )
city = ["北京", "上海", "深圳", "成都", "长春","大连","义务","杭州"]
gender = ["1","2"]
class ReadFile:
    def readLines(self):
        f = open("./avatar1.txt", "r")
        list=[]
    
        for line in f:
            strs = line.split("||")

            if len(strs) != 4:
                continue
	    province = random.choice(city)
            data=(strs[1], strs[2],strs[0],strs[3].replace("\n",""),random.choice(gender),province,province,str(random.randint(100000000,999999999)),'10','0','0','127.0.0.1','1','1','20','100','0','0','0','0','0','0','0','0','1','0','2016-8-2','2016-8-2','2016-8-2')

            list.append(data)


        #if i>0:
            #cursor.executemany(sql,list)
            #cnx.commit()
        #cnx.close()
        cursor=cnx.cursor()
        sql = "insert into customer_user(`identity`,`image`,`desc`,`nickname`,`gender`,`province`,`city`,`openid`,`platform`,`longitude`,`latitude`,`ip`,`level_id`,`level_desc`,`last_experience`,`source`,`has_message_unread`,`experience`,`ticket`,`locked_ticket`,`total_ticket`,`cost`,`contribute_experience`,`contribute_ticket`,`is_block`,`is_premium`,`first_purchase_at`,`first_gift_at`,`created_at`)values(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"
        cursor.executemany(sql,list)
        cnx.commit()
        print("插入")

        #list.clear()        
        f.close()
        print("ok")

    def listFiles(self):
        d = os.listdir("./")
        return d

            
if __name__ == "__main__":
    readFile = ReadFile()
    readFile.readLines()
